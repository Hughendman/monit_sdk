/*! Monit_SDK 2018-03-26 */
!function(a){"use strict";if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a());else{var b;if("undefined"==typeof window)throw new Error("wrong execution environment");b=window,b.M2=a()}}(function(){"use strict";var a={},b=document,c=window.navigator,d=window.screen,f=isLocal?"":b.domain.toLowerCase(),g=c.userAgent.toLowerCase(),h=function(a){return function(b){return Object.prototype.toString.call(b)==="[object "+a+"]"}},i={get:function(a){var c=""+b.cookie,d=c.indexOf(a);if(void 0===a||""===a||-1===d)return"";var e=c.indexOf(";",d);return-1==e&&(e=c.length),unescape(c.substring(d+a.length+1,e))},set:function(a,c,d,e,f){var g=new Date;d=d||730,f=f||"/",g.setTime(g.getTime()+24*d*60*60*1e3);var h="; expires="+g.toGMTString(),i=a+"="+c+h+"; path="+f;e&&(i+="; domain="+e),b.cookie=i},remove:function(a){i.get(a)&&i.set(a,"",-1,"/")}},j={is:function(){var a="modernizr";try{return window.sessionStorage.setItem(a,a),window.sessionStorage.removeItem(a),!0}catch(a){return!1}},get:function(a){if(j.is())return window.sessionStorage.getItem(a);console.log("sessionStorage error: get "+a)},set:function(a,b){if(j.is())return window.sessionStorage.setItem(a,b);console.log("sessionStorage error: set name:"+a+",value:"+b)},remove:function(a){if(j.is())return window.sessionStorage.removeItem(a);console.log("sessionStorage error: remove "+a)}},k={trim:function(a){return a.replace(/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g,"")},encodeObject2URIString:function(a){if("string"==typeof a)return a;var b=[];for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},stringify:function(a){var b=typeof a,c=k.stringify;if("object"!==b||null===a)return"string"===b&&(a='"'+a+'"'),String(a);if("object"==typeof JSON&&JSON.stringify)return JSON.stringify(a);var d,e=[],f=a&&a.constructor===Array;for(var g in a)a.hasOwnProperty(g)&&(d=a[g],b=typeof d,"string"===b?d='"'+d+'"':"object"===b&&null!==d&&(d=c(d)),e.push((f?"":'"'+g+'":')+String(d)));return(f?"[":"{")+String(e)+(f?"]":"}")},parseJSON:function(a){var b=/^[\],:{}\s]*$/,c=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,d=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,e=/(?:^|:|,)(?:\s*\[)+/g;return"object"==typeof a?a:"string"==typeof a&&a?(a=a.replace(/(^\s+)|(\s+$)/g,""),b.test(a.replace(c,"@").replace(d,"]").replace(e,""))?window.JSON&&window.JSON.parse?window.JSON.parse(a):new Function("return "+a)():a):null},bind:function(a,b){return Function.prototype.bind?a.bind(b):function(){a.apply(b,arguments)}},hasSearch:function(a,b){var c="";return c=/\?/.test(a)?"&":"?",a+c+b},forIn:function(a,b){if(k.isObject(a))for(var c in a)a.hasOwnProperty(c)&&b.call(null,c,a[c])},each:function(){return[].forEach?function(a){[].forEach.apply(a,[].slice.call(arguments,1))}:function(a,b){for(var c=0,d=a.length;c<d;c++)b.call(arguments[2],a[c],c,a)}}(),init:function(){k.each(["Object","String","Function","Array"],function(a){k["is"+a]=h(a)})},isPureObject:function(a){return!(!k.isObject(a)||a.constructor!==Object)}};k.init();var l={init:function(){var c={title:b.title||"",url:l.getUrl(),guid:l.getGuid(),referrer:l.getReferrer(),ua:g,browser:l.getBrowser(),viewport:l.getViewportSize(),lang:l.getLang(),appenv:l.getAppenv(),is_admin:l.isAdmin};k.forIn(c,function(b,c){a[b]=c})},isAdmin:i.get("is_admin")||"",getLang:function(){var a=i.get("felangague");return a||(a=c.language||c.systemLanguage),a},getBrowser:function(){var a={"360se-ua":"360se",TT:"tencenttraveler",Maxthon:"maxthon",GreenBrowser:"greenbrowser",Sogou:"se 1.x / se 2.x",TheWorld:"theworld"};for(var b in a)if(g.indexOf(a[b])>-1)return b;var c=!1;try{+external.twGetVersion(external.twGetSecurityID(window)).replace(/\./g,"")>1013&&(c=!0)}catch(a){console.log(a)}if(c)return"360se-noua";var d=g.match(/(msie|chrome|safari|firefox|opera|trident)/);return d=d?d[0]:"","msie"==d?d=g.match(/msie[^;]+/)+"":"trident"==d&&g.replace(/trident\/[0-9].*rv[ :]([0-9.]+)/gi,function(a,b){d="msie "+b}),d},getAppenv:function(){var a=i.get("appenv")||"",b=j.get("appenv");return a||(b||(a="test"),j.set("appenv",a)),a},getUrl:function(){var a="";try{a=location.href}catch(c){a=b.createElement("a"),a.href="",a=a.href}return a},getReferrer:function(){var a="__referrer",c=j.get(a),d=window.location.referrer;b.URL||window.location.href;return c||(d&&d!=c&&(c=d),d||(c=l.getUrl()),j.set(a,c)),c},getViewportSize:function(){try{var a=top.document.documentElement,b=(e=top.document.body)&&top.document.clientWidth&&top.document.clientHeight}catch(c){var a=a.documentElement,b=(c=a.body)&&a.clientWidth&&a.clientHeight}var c=[];return a&&a.clientWidth&&a.clientHeight&&("CSS1Compat"===a.compatMode||!b)?c=[a.clientWidth,a.clientHeight]:b&&(c=[a.clientWidth,a.clientHeight]),k.stringify({w:c[0],h:c[1]})},isLocal:function(){var a=!0,b=window.location.protocol.toLowerCase();return"http:"!=b&&"https:"!=b||(a=!1),a},getGuid:function(){function a(a){var b=0,c=0,d=a.length-1;for(d;d>=0;d--){var e=parseInt(a.charCodeAt(d),10);b=(b<<6&268435455)+e+(e<<14),0!=(c=266338304&b)&&(b^=c>>21)}return b}function e(){for(var e=[c.appName,c.version,c.language||c.browserLanguage,c.platform,c.userAgent,d.width,"x",d.height,d.colorDepth,b.referrer].join(""),f=e.length,g=window.history.length;g;)e+=g--^f++;return 2147483647*(Math.round(2147483647*Math.random())^a(e))}var g="__guid",h=i.get(g);if(!h){h=[a(l.isLocal()?"":b.domain),e(),+new Date+Math.random()+Math.random()].join(".");var j={expires:300,domain:"localhost",path:"/"},k=["bw.cn","brandwisdom.cn","jointwisdom.cn"];if(k.length)for(var m=0;m<k.length;m++){var n=k[m],o="."+n;if(f.indexOf(o)>0&&f.lastIndexOf(o)==f.length-o.length||f==n){j.domain=o;break}}i.set(g,h,j.expires,j.domain,j.path)}return h}},m={clickInit:function(b){m._event(document,"click",function(c){var d=c.target||c.srcElement,e={m_type:1,attributes:m.getAttributeList(d,!0),parent_attributes:m.getAttributeList(m.parentNode(d,"div"),!1)};k.forIn(e,function(b,c){a[b]=c}),console.log("发起埋点......."),b()},!0)},parentNode:function(a,b,c){if(c=c||50,b=b.toUpperCase(),"BODY"===a.tagName||"HTML"===a.tagName)return a;for(;a&&c-- >0;){if(a.tagName===b&&""!==a.className)return a;a=a.parentNode}return a},getAttributeList:function(b,c){var d={},e=b.attributes||[],f="";return b.tagName?(d.tagName=b.tagName,d.tagText=m.getText(b),k.each(e,function(b,e,g){"cid"===b.name&&c?f=b.value:d[b.name]=encodeURIComponent(b.value),a.cid=f}),k.stringify(d)):""},getText:function(a){var b="";return"input"==a.tagName.toLowerCase()?b=a.value||"":"body"!=a.tagName.toLowerCase()&&"html"!=a.tagName.toLowerCase()&&a.childNodes.length<=1&&(b=a.innerText||a.textContent||""),b.replace(/^\s*|\s*$/g,"").substr(0,100)},_event:function(){function a(a,c,d){return function(e){if(e=e||b(window.event)){var f,g,h=!0;return/^\s\bfunction\b/.test(d)&&(f=d(e)),g=c.call(a,e),!1!==f&&!1!==g||(h=!1),h}}}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void console.error("No valid element provided to register_event");if(b.addEventListener)b.addEventListener(c,d,!!e);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}()},n={postMonit:function(){var b=new Image,c=window.M2_URL||"",d="",e=k.parseJSON(j.get("M2_USER"))||{};if(a.pid=window.M2_PNAME||"",a.uid=e.uid||"",a.hid=e.hid||"",a.custom_tag=j.get("M2_CUSTOM_TAG")||"",!a.pid&&!c)throw new TypeError("M2_PNAME or M2_URL is not null....");k.forIn(a,function(a,b){d+="&"+a+"="+b}),b.src=c+"?t="+(new Date).getTime()+d},setUserInfo:function(b){if(k.isArray(b)||k.isObject(b)){var c={uid:b.uid||"",hid:b.hid||""};j.set("M2_USER",k.stringify(c))}k.forIn(c,function(b,c){a[b]=c})},setAttrs:function(a){if(!k.isObject(a))throw new TypeError("格式不正确");var b=j.get("M2_CUSTOM_TAG"),c=k.parseJSON(b);b?k.forIn(a,function(a,b){k.isArray(b)||k.isObject(b)?c[a]=k.stringify(b):c[a]=b}):c=a,j.set("M2_CUSTOM_TAG",k.stringify(c))},getAttr:function(a){var b=j.get("M2_CUSTOM_TAG");return b?a?k.parseJSON(b)[a]:k.parseJSON(b):"无设置自定义属性"},removeAttr:function(a){var b=j.get("M2_CUSTOM_TAG"),c="",d={};return b||a?(c=k.parseJSON(b),c[a]?(k.forIn(c,function(b,c){b!==a&&(d[b]=c)}),j.set("M2_CUSTOM_TAG",k.stringify(d)),"删除成功"):"未查到此属性"):"无设置自定义属性"}},o=function(){l.init()};o.prototype.init=function(){m.clickInit(function(){n.postMonit()})},o.prototype.setMoint=function(b,c,d){var e=!!b&&(b.target||b.srcElement);a.m_type=3,a.cid=d,a.attributes="",a.parent_attributes="",e&&(a.attributes=m.getAttributeList(e,!0),a.parent_attributes=m.getAttributeList(m.parentNode(e,"div"),!1)),n.setAttrs(c),n.postMonit()},o.prototype._getQuest=function(b,c,d){var e=!!b&&(b.target||b.srcElement);a.m_type=3,a.cid=d,a.attributes="",a.parent_attributes="",e&&(a.attributes=m.getAttributeList(e,!0),a.parent_attributes=m.getAttributeList(m.parentNode(e,"div"),!1)),n.setAttrs(c),n.postMonit()};var p=new o;p.init();var q=function(a){if(!k.isObject(a))throw new TypeError("参数不正确");var b={};return k.forIn(b,function(c){b[c]=a[c]||b[c]}),""};return k.forIn({getQuest:"_getQuest",setMoint:"setMoint",getAttr:"getAttr",setAttrs:"setAttrs",removeAttr:"removeAttr",setUserInfo:"setUserInfo"},function(a,b){q[a]=function(){return p[b]?p[b].apply(null,arguments):n[b].apply(null,arguments)}}),q.version="0.9.0",q});