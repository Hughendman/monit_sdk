/*! Monit_SDK 2018-03-22 */
!function(a){"use strict";if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a());else{var b;if("undefined"==typeof window)throw new Error("wrong execution environment");b=window,b.M2=a()}}(function(){"use strict";var a={},b=function(a){return function(b){return Object.prototype.toString.call(b)==="[object "+a+"]"}},c={get:function(a){var b=""+window.document.cookie,c=b.indexOf(a);if(void 0===a||""===a||-1===c)return"";var d=b.indexOf(";",c);return-1==d&&(d=b.length),unescape(b.substring(c+a.length+1,d))},set:function(a,b,c,d,e){var f=new Date;c=c||730,e=e||"/",f.setTime(f.getTime()+24*c*60*60*1e3);var g="; expires="+f.toGMTString(),h=a+"="+b+g+"; path="+e;d&&(h+="; domain="+d),window.document.cookie=h},remove:function(a){c.get(a)&&c.set(a,"",-1,"/")}},d={is:function(){var a="modernizr";try{return window.sessionStorage.setItem(a,a),window.sessionStorage.removeItem(a),!0}catch(a){return!1}},get:function(a){if(d.is())return window.sessionStorage.getItem(a);console.log("sessionStorage error: get "+a)},set:function(a,b){if(d.is())return window.sessionStorage.setItem(a,b);console.log("sessionStorage error: set name:"+a+",value:"+b)},remove:function(a){if(d.is())return window.sessionStorage.removeItem(a);console.log("sessionStorage error: remove "+a)}},f={encodeObject2URIString:function(a){if("string"==typeof a)return a;var b=[];for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},stringify:function(a){var b=typeof a,c=f.stringify;if("object"!==b||null===a)return"string"===b&&(a='"'+a+'"'),String(a);if("object"==typeof JSON&&JSON.stringify)return JSON.stringify(a);var d,e=[],g=a&&a.constructor===Array;for(var h in a)a.hasOwnProperty(h)&&(d=a[h],b=typeof d,"string"===b?d='"'+d+'"':"object"===b&&null!==d&&(d=c(d)),e.push((g?"":'"'+h+'":')+String(d)));return(g?"[":"{")+String(e)+(g?"]":"}")},parseJSON:function(a){var b=/^[\],:{}\s]*$/,c=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,d=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,e=/(?:^|:|,)(?:\s*\[)+/g;return"object"==typeof a?a:"string"==typeof a&&a?(a=a.replace(/(^\s+)|(\s+$)/g,""),b.test(a.replace(c,"@").replace(d,"]").replace(e,""))?window.JSON&&window.JSON.parse?window.JSON.parse(a):new Function("return "+a)():a):null},bind:function(a,b){return Function.prototype.bind?a.bind(b):function(){a.apply(b,arguments)}},hasSearch:function(a,b){var c="";return c=/\?/.test(a)?"&":"?",a+c+b},forIn:function(a,b){if(f.isObject(a))for(var c in a)a.hasOwnProperty(c)&&b.call(null,c,a[c])},each:function(){return[].forEach?function(a){[].forEach.apply(a,[].slice.call(arguments,1))}:function(a,b){for(var c=0,d=a.length;c<d;c++)b.call(arguments[2],a[c],c,a)}}(),init:function(){f.each(["Object","String","Function","Array"],function(a){f["is"+a]=b(a)})},isPureObject:function(a){return!(!f.isObject(a)||a.constructor!==Object)}};f.init();var g={init:function(){var b={title:document.title||"",url:g.getUrl(),guid:g.getGuid(),referrer:g.getReferrer(),ua:g.ua,browser:g.getBrowser(),viewport:g.getViewportSize(),lang:g.getLang(),appenv:g.getAppenv(),is_admin:g.isAdmin};f.forIn(b,function(b,c){a[b]=c})},isAdmin:c.get("is_admin")||"",getLang:function(){var a=c.get("felangague");return a||(a=window.navigator.language||window.navigator.systemLanguage),a},ua:window.navigator.userAgent,getBrowser:function(){var a=g.ua.toLowerCase(),b={"360se-ua":"360se",TT:"tencenttraveler",Maxthon:"maxthon",GreenBrowser:"greenbrowser",Sogou:"se 1.x / se 2.x",TheWorld:"theworld"};for(var c in b)if(a.indexOf(b[c])>-1)return c;var d=!1;try{+external.twGetVersion(external.twGetSecurityID(window)).replace(/\./g,"")>1013&&(d=!0)}catch(a){}if(d)return"360se-noua";var e=a.match(/(msie|chrome|safari|firefox|opera|trident)/);return e=e?e[0]:"","msie"==e?e=a.match(/msie[^;]+/)+"":"trident"==e&&a.replace(/trident\/[0-9].*rv[ :]([0-9.]+)/gi,function(a,b){e="msie "+b}),e},getAppenv:function(){var a=c.get("appenv")||"",b=d.get("appenv");return a||(b||(a="test"),d.set("appenv",a)),a},getUrl:function(){var a="";try{a=location.href}catch(b){a=document.createElement("a"),a.href="",a=a.href}return a},getReferrer:function(){var a="__referrer",b=d.get(a),c=window.location.referrer;document.URL||window.location.href;return b||(c&&c!=b&&(b=c),c||(b=g.getUrl()),d.set(a,b)),b},getViewportSize:function(){try{var a=top.document.documentElement,b=(e=top.document.body)&&top.document.clientWidth&&top.document.clientHeight}catch(c){var a=document.documentElement,b=(c=document.body)&&document.clientWidth&&document.clientHeight}var c=[];return a&&a.clientWidth&&a.clientHeight&&("CSS1Compat"===document.compatMode||!b)?c=[a.clientWidth,a.clientHeight]:b&&(c=[a.clientWidth,a.clientHeight]),f.stringify({w:c[0],h:c[1]})},isLocal:function(){var a=!0,b=window.location.protocol.toLowerCase();return"http:"!=b&&"https:"!=b||(a=!1),a},getGuid:function(){function a(a){var b=0,c=0,d=a.length-1;for(d;d>=0;d--){var e=parseInt(a.charCodeAt(d),10);b=(b<<6&268435455)+e+(e<<14),0!=(c=266338304&b)&&(b^=c>>21)}return b}function b(){for(var b=[e.appName,e.version,e.language||e.browserLanguage,e.platform,e.userAgent,h.width,"x",h.height,h.colorDepth,f.referrer].join(""),c=b.length,d=window.history.length;d;)b+=d--^c++;return 2147483647*(Math.round(2147483647*Math.random())^a(b))}var d="__guid",e=window.navigator,f=document,h=window.screen,i=g.isLocal()?"":document.domain.toLowerCase(),j=(e.userAgent.toLowerCase(),c.get(d));if(!j){j=[a(g.isLocal()?"":f.domain),b(),+new Date+Math.random()+Math.random()].join(".");var k={expires:300,domain:"localhost",path:"/"},l=["bw.cn","brandwisdom.cn","jointwisdom.cn"];if(l.length)for(var m=0;m<l.length;m++){var n=l[m],o="."+n;if(i.indexOf(o)>0&&i.lastIndexOf(o)==i.length-o.length||i==n){k.domain=o;break}}c.set(d,j,k.expires,k.domain,k.path)}return j}},h={clickInit:function(b){h._event(document,"click",function(c){var d=c.target||c.srcElement,e={m_type:1,attributes:h.getAttributeList(d,!0),parent_attributes:h.getAttributeList(h.parentNode(d,"div"),!1)};f.forIn(e,function(b,c){a[b]=c}),console.log("发起埋点......."),b()},!0)},parentNode:function(a,b,c){if(c=c||50,b=b.toUpperCase(),"BODY"===a.tagName||"HTML"===a.tagName)return a;for(;a&&c-- >0;){if(a.tagName===b&&""!==a.className)return a;a=a.parentNode}return a},getAttributeList:function(b,c){var d={},e=b.attributes||[],g="";return b.tagName?(d.tagName=b.tagName,d.tagText=h.getText(b),f.each(e,function(b,e,f){"cid"===b.name&&c?g=b.value:d[b.name]=encodeURIComponent(b.value),a.cid=g}),f.stringify(d)):""},getText:function(a){var b="";return"input"==a.tagName.toLowerCase()?b=a.value||"":"body"!=a.tagName.toLowerCase()&&"html"!=a.tagName.toLowerCase()&&a.childNodes.length<=1&&(b=a.innerText||a.textContent||""),b.replace(/^\s*|\s*$/g,"").substr(0,100)},_event:function(){function a(a,c,d){return function(e){if(e=e||b(window.event)){var f,g,h=!0;return/^\s\bfunction\b/.test(d)&&(f=d(e)),g=c.call(a,e),!1!==f&&!1!==g||(h=!1),h}}}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void console.error("No valid element provided to register_event");if(b.addEventListener)b.addEventListener(c,d,!!e);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}()},i={postMonit:function(){var b=new Image,c=window.M2_URL||"",e="",g=f.parseJSON(d.get("M2_USER"))||{};if(a.pid=window.M2_PNAME||"",a.uid=g.uid||"",a.hid=g.hid||"",a.custom_tag=d.get("M2_CUSTOM_TAG")||"",!a.pid&&!c)throw new TypeError("M2_PNAME or M2_URL is not null....");f.forIn(a,function(a,b){e+="&"+a+"="+b}),b.src=c+"?t="+(new Date).getTime()+e},setUserInfo:function(b){if(f.isArray(b)||f.isObject(b)){var c={uid:b.uid||"",hid:b.hid||""};d.set("M2_USER",f.stringify(c))}f.forIn(c,function(b,c){a[b]=c})},setAttrs:function(a){if(!f.isObject(a))throw new TypeError("格式不正确");var b=d.get("M2_CUSTOM_TAG"),c=f.parseJSON(b);b?f.forIn(a,function(a,b){f.isArray(b)||f.isObject(b)?c[a]=f.stringify(b):c[a]=b}):c=a,d.set("M2_CUSTOM_TAG",f.stringify(c))},getAttr:function(a){var b=d.get("M2_CUSTOM_TAG");return b?a?f.parseJSON(b)[a]:f.parseJSON(b):"无设置自定义属性"},removeAttr:function(a){var b=d.get("M2_CUSTOM_TAG"),c="",e={};return b||a?(c=f.parseJSON(b),c[a]?(f.forIn(c,function(b,c){b!==a&&(e[b]=c)}),d.set("M2_CUSTOM_TAG",f.stringify(e)),"删除成功"):"未查到此属性"):"无设置自定义属性"}},j=function(){g.init()};j.prototype.init=function(){h.clickInit(function(){i.postMonit()})},j.prototype.setMoint=function(b,c,d){var e=!!b&&(b.target||b.srcElement);a.m_type=3,a.cid=d,a.attributes="",a.parent_attributes="",e&&(a.attributes=h.getAttributeList(e,!0),a.parent_attributes=h.getAttributeList(h.parentNode(e,"div"),!1)),i.setAttrs(c),i.postMonit()},j.prototype._getQuest=function(b,c,d){var e=!!b&&(b.target||b.srcElement);a.m_type=3,a.cid=d,a.attributes="",a.parent_attributes="",e&&(a.attributes=h.getAttributeList(e,!0),a.parent_attributes=h.getAttributeList(h.parentNode(e,"div"),!1)),i.setAttrs(c),i.postMonit()};var k=new j;k.init();var l=function(a){if(!f.isObject(a))throw new TypeError("参数不正确");var b={};return f.forIn(b,function(c){b[c]=a[c]||b[c]}),""};return f.forIn({getQuest:"_getQuest",setMoint:"setMoint",getAttr:"getAttr",setAttrs:"setAttrs",removeAttr:"removeAttr",setUserInfo:"setUserInfo"},function(a,b){l[a]=function(){return k[b]?k[b].apply(null,arguments):i[b].apply(null,arguments)}}),l.version="0.9.0",l});