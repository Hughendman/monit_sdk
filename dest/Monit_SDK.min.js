/*! Monit_SDK 2018-03-27 */
!function(a){"use strict";if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a());else{var b;if("undefined"==typeof window)throw new Error("wrong execution environment");b=window,b.M2=a()}}(function(){"use strict";window.console=window.console||function(){var a={};return a.log=a.warn=a.debug=a.info=a.error=a.time=a.dir=a.profile=a.clear=a.exception=a.trace=a.assert=function(){},a}();var a,b={};!function(){a=!0;try{var b=location.protocol.toLowerCase();"http:"!=b&&"https:"!=b||(a=!1)}catch(a){}}();var c=document,d=window.navigator,e=window.screen,f=a?"":c.domain.toLowerCase(),g=d.userAgent.toLowerCase(),h=function(a){return function(b){return Object.prototype.toString.call(b)==="[object "+a+"]"}},i={get:function(a){var b=""+c.cookie,d=b.indexOf(a);if(void 0===a||""===a||-1===d)return"";var e=b.indexOf(";",d);return-1==e&&(e=b.length),unescape(b.substring(d+a.length+1,e))},set:function(a,b,d,e,f){var g=new Date;d=d||730,f=f||"/",g.setTime(g.getTime()+24*d*60*60*1e3);var h="; expires="+g.toGMTString(),i=a+"="+b+h+"; path="+f;e&&(i+="; domain="+e),c.cookie=i},remove:function(a){i.get(a)&&i.set(a,"",-1,"/")}},j={is:function(){var a="modernizr";try{return window.sessionStorage.setItem(a,a),window.sessionStorage.removeItem(a),!0}catch(a){return!1}},get:function(a){if(j.is())return window.sessionStorage.getItem(a);console.log("sessionStorage error: get "+a)},set:function(a,b){if(j.is())return window.sessionStorage.setItem(a,b);console.log("sessionStorage error: set name:"+a+",value:"+b)},remove:function(a){if(j.is())return window.sessionStorage.removeItem(a);console.log("sessionStorage error: remove "+a)}},k={trim:function(a){return a.replace(/^[\s\xa0\u3000]+|[\u3000\xa0\s]+$/g,"")},encodeObject2URIString:function(a){if("string"==typeof a)return a;var b=[];for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},stringify:function(a){var b=typeof a,c=k.stringify;if("object"!==b||null===a)return"string"===b&&(a='"'+a+'"'),String(a);if("object"==typeof JSON&&JSON.stringify)return JSON.stringify(a);var d,e=[],f=a&&a.constructor===Array;for(var g in a)a.hasOwnProperty(g)&&(d=a[g],b=typeof d,"string"===b?d='"'+d+'"':"object"===b&&null!==d&&(d=c(d)),e.push((f?"":'"'+g+'":')+String(d)));return(f?"[":"{")+String(e)+(f?"]":"}")},parseJSON:function(a){var b=/^[\],:{}\s]*$/,c=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,d=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,e=/(?:^|:|,)(?:\s*\[)+/g;return"object"==typeof a?a:"string"==typeof a&&a?(a=a.replace(/(^\s+)|(\s+$)/g,""),b.test(a.replace(c,"@").replace(d,"]").replace(e,""))?window.JSON&&window.JSON.parse?window.JSON.parse(a):new Function("return "+a)():a):null},bind:function(a,b){return Function.prototype.bind?a.bind(b):function(){a.apply(b,arguments)}},hasSearch:function(a,b){var c="";return c=/\?/.test(a)?"&":"?",a+c+b},forIn:function(a,b){if(k.isObject(a))for(var c in a)a.hasOwnProperty(c)&&b.call(null,c,a[c])},each:function(){return[].forEach?function(a){[].forEach.apply(a,[].slice.call(arguments,1))}:function(a,b){for(var c=0,d=a.length;c<d;c++)b.call(arguments[2],a[c],c,a)}}(),init:function(){k.each(["Object","String","Function","Array"],function(a){k["is"+a]=h(a)})},isPureObject:function(a){return!(!k.isObject(a)||a.constructor!==Object)}};k.init();var l={init:function(){var a={title:c.title||"",url:l.getUrl(),guid:l.getGuid(),referrer:l.getReferrer(),ua:g,browser:l.getBrowser(),viewport:l.getViewportSize(),lang:l.getLang(),appenv:l.getAppenv(),is_admin:l.isAdmin};k.forIn(a,function(a,c){b[a]=c})},isAdmin:i.get("is_admin")||"",getLang:function(){var a=i.get("felangague");return a||(a=d.language||d.systemLanguage),a},getBrowser:function(){var a={"360se-ua":"360se",TT:"tencenttraveler",Maxthon:"maxthon",GreenBrowser:"greenbrowser",Sogou:"se 1.x / se 2.x",TheWorld:"theworld"};for(var b in a)if(g.indexOf(a[b])>-1)return b;var c=!1;try{+external.twGetVersion(external.twGetSecurityID(window)).replace(/\./g,"")>1013&&(c=!0)}catch(a){}if(c)return"360se-noua";var d=g.match(/(msie|chrome|safari|firefox|opera|trident)/);return d=d?d[0]:"","msie"==d?d=g.match(/msie[^;]+/)+"":"trident"==d&&g.replace(/trident\/[0-9].*rv[ :]([0-9.]+)/gi,function(a,b){d="msie "+b}),d},getAppenv:function(){var a=i.get("appenv")||"",b=j.get("appenv");return a||(b||(a="test"),j.set("appenv",a)),a},getUrl:function(){var a="";try{a=location.href}catch(b){a=c.createElement("a"),a.href="",a=a.href}return a},getReferrer:function(){var a="__referrer",b=j.get(a),d=window.location.referrer;c.URL||window.location.href;return b||(d&&d!=b&&(b=d),d||(b=l.getUrl()),j.set(a,b)),b},getViewportSize:function(){try{var a=top.document.documentElement,b=top.document.body&&top.document.clientWidth&&top.document.clientHeight}catch(c){var a=a.documentElement,b=(c=a.body)&&a.clientWidth&&a.clientHeight}var c=[];return a&&a.clientWidth&&a.clientHeight&&("CSS1Compat"===a.compatMode||!b)?c=[a.clientWidth,a.clientHeight]:b&&(c=[a.clientWidth,a.clientHeight]),k.stringify({w:c[0],h:c[1]})},getGuid:function(){function b(a){var b=0,c=0,d=a.length-1;for(d;d>=0;d--){var e=parseInt(a.charCodeAt(d),10);b=(b<<6&268435455)+e+(e<<14),0!=(c=266338304&b)&&(b^=c>>21)}return b}function g(){for(var a=[d.appName,d.version,d.language||d.browserLanguage,d.platform,d.userAgent,e.width,"x",e.height,e.colorDepth,c.referrer].join(""),f=a.length,g=window.history.length;g;)a+=g--^f++;return 2147483647*(Math.round(2147483647*Math.random())^b(a))}var h="__guid",j=i.get(h);if(!j){j=[b(a?"":c.domain),g(),+new Date+Math.random()+Math.random()].join(".");var k={expires:300,domain:"localhost",path:"/"},l=["bw.cn","brandwisdom.cn","jointwisdom.cn"];if(l.length)for(var m=0;m<l.length;m++){var n=l[m],o="."+n;if(f.indexOf(o)>0&&f.lastIndexOf(o)==f.length-o.length||f==n){k.domain=o;break}}i.set(h,j,k.expires,k.domain,k.path)}return j}},m={clickInit:function(a){m._event(document,"click",function(c){var d=c.target||c.srcElement,e={m_type:1,attributes:m.getAttributeList(d,!0),parent_attributes:m.getAttributeList(m.parentNode(d,"div"),!1)};k.forIn(e,function(a,c){b[a]=c}),a()},!0)},parentNode:function(a,b,c){if(c=c||50,b=b.toUpperCase(),"BODY"===a.tagName||"HTML"===a.tagName)return a;for(;a&&c-- >0;){if(a.tagName===b&&""!==a.className)return a;a=a.parentNode}return a},getAttributeList:function(a,c){var d={},e=a.attributes||[],f="";return a.tagName?(d.tagName=a.tagName,d.tagText=m.getText(a),k.each(e,function(a,e,g){"cid"===a.name&&c?f=a.value:d[a.name]=encodeURIComponent(a.value),b.cid=f}),k.stringify(d)):""},getText:function(a){var b="";return"input"==a.tagName.toLowerCase()?b=a.value||"":"body"!=a.tagName.toLowerCase()&&"html"!=a.tagName.toLowerCase()&&a.childNodes.length<=1&&(b=a.innerText||a.textContent||""),b.replace(/^\s*|\s*$/g,"").substr(0,100)},_event:function(){function a(a,c,d){return function(e){if(e=e||b(window.event)){var f,g,h=!0;return/^\s\bfunction\b/.test(d)&&(f=d(e)),g=c.call(a,e),!1!==f&&!1!==g||(h=!1),h}}}function b(a){return a&&(a.preventDefault=b.preventDefault,a.stopPropagation=b.stopPropagation),a}var c=function(b,c,d,e){if(!b)return void console.error("No valid element provided to register_event");if(b.addEventListener)b.addEventListener(c,d,!!e);else{var f="on"+c,g=b[f];b[f]=a(b,d,g)}};return b.preventDefault=function(){this.returnValue=!1},b.stopPropagation=function(){this.cancelBubble=!0},c}()},n={postMonit:function(){var a=new Image,c=window.M2_URL||"",d=k.parseJSON(j.get("M2_USER"))||{};if(b.pid=window.M2_PNAME||"",b.uid=d.uid||"",b.hid=d.hid||"",b.custom_tag=j.get("M2_CUSTOM_TAG")||"",!b.pid&&!c)throw new TypeError("M2_PNAME or M2_URL is not null....");var e="&"+k.encodeObject2URIString(b);a.src=c+"?t="+(new Date).getTime()+e},setUserInfo:function(a){if(k.isArray(a)||k.isObject(a)){var c={uid:a.uid||"",hid:a.hid||""};j.set("M2_USER",k.stringify(c))}k.forIn(c,function(a,c){b[a]=c})},setAttrs:function(a){if(!k.isObject(a))throw new TypeError("格式不正确");var b=j.get("M2_CUSTOM_TAG"),c=k.parseJSON(b);b?k.forIn(a,function(a,b){k.isArray(b)||k.isObject(b)?c[a]=k.stringify(b):c[a]=b}):c=a,j.set("M2_CUSTOM_TAG",k.stringify(c))},getAttr:function(a){var b=j.get("M2_CUSTOM_TAG");return b?a?k.parseJSON(b)[a]:k.parseJSON(b):"无设置自定义属性"},removeAttr:function(a){var b=j.get("M2_CUSTOM_TAG"),c="",d={};return b||a?(c=k.parseJSON(b),c[a]?(k.forIn(c,function(b,c){b!==a&&(d[b]=c)}),j.set("M2_CUSTOM_TAG",k.stringify(d)),"删除成功"):"未查到此属性"):"无设置自定义属性"}},o=function(){l.init()};o.prototype.init=function(){m.clickInit(function(){n.postMonit()})},o.prototype.setMoint=function(a,c,d){var e=!!a&&(a.target||a.srcElement);b.m_type=3,b.cid=d,b.attributes="",b.parent_attributes="",e&&(b.attributes=m.getAttributeList(e,!0),b.parent_attributes=m.getAttributeList(m.parentNode(e,"div"),!1)),n.setAttrs(c),n.postMonit()},o.prototype._getQuest=function(a,c,d){var e=!!a&&(a.target||a.srcElement);b.m_type=3,b.cid=d,b.attributes="",b.parent_attributes="",e&&(b.attributes=m.getAttributeList(e,!0),b.parent_attributes=m.getAttributeList(m.parentNode(e,"div"),!1)),n.setAttrs(c),n.postMonit()};var p=new o;p.init();var q=function(a){if(!k.isObject(a))throw new TypeError("参数不正确");var b={};return k.forIn(b,function(c){b[c]=a[c]||b[c]}),""};return k.forIn({getQuest:"_getQuest",setMoint:"setMoint",getAttr:"getAttr",setAttrs:"setAttrs",removeAttr:"removeAttr",setUserInfo:"setUserInfo"},function(a,b){q[a]=function(){return p[b]?p[b].apply(null,arguments):n[b].apply(null,arguments)}}),q.version="0.9.0",q});